{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://D%3A/JewelleryWEBApp/front_end/src/utils/formatters.ts"],"sourcesContent":["/**\n * Format a number as currency\n * @param value The number to format\n * @param locale The locale to use for formatting (default: 'en-US')\n * @param currency The currency code (default: 'LKR')\n * @returns Formatted currency string\n */\nexport const formatCurrency = (\n  value: number | string,\n  locale: string = 'en-US',\n  currency: string = 'LKR'\n): string => {\n  // Convert to number if it's a string\n  const numericValue = typeof value === 'string' ? parseFloat(value) : value;\n\n  // Handle NaN values\n  if (isNaN(numericValue)) {\n    console.warn('Invalid value for currency formatting:', value);\n    return 'Rs. 0.00';\n  }\n\n  // Use the Sri Lankan Rupee symbol (Rs) instead of LKR text\n  return 'Rs. ' + new Intl.NumberFormat(locale, {\n    style: 'decimal',\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2,\n  }).format(numericValue);\n};\n\n/**\n * Format a date string\n * @param dateString The date string to format\n * @param locale The locale to use for formatting (default: 'en-US')\n * @returns Formatted date string\n */\nexport const formatDate = (\n  dateString: string,\n  locale: string = 'en-US'\n): string => {\n  const date = new Date(dateString);\n  return new Intl.DateTimeFormat(locale, {\n    year: 'numeric',\n    month: 'numeric',\n    day: 'numeric',\n    hour: 'numeric',\n    minute: 'numeric',\n    hour12: true\n  }).format(date);\n};\n"],"names":[],"mappings":"AAAA;;;;;;CAMC;;;;AACM,MAAM,iBAAiB,CAC5B,OACA,SAAiB,OAAO,EACxB,WAAmB,KAAK;IAExB,qCAAqC;IACrC,MAAM,eAAe,OAAO,UAAU,WAAW,WAAW,SAAS;IAErE,oBAAoB;IACpB,IAAI,MAAM,eAAe;QACvB,QAAQ,IAAI,CAAC,0CAA0C;QACvD,OAAO;IACT;IAEA,2DAA2D;IAC3D,OAAO,SAAS,IAAI,KAAK,YAAY,CAAC,QAAQ;QAC5C,OAAO;QACP,uBAAuB;QACvB,uBAAuB;IACzB,GAAG,MAAM,CAAC;AACZ;AAQO,MAAM,aAAa,CACxB,YACA,SAAiB,OAAO;IAExB,MAAM,OAAO,IAAI,KAAK;IACtB,OAAO,IAAI,KAAK,cAAc,CAAC,QAAQ;QACrC,MAAM;QACN,OAAO;QACP,KAAK;QACL,MAAM;QACN,QAAQ;QACR,QAAQ;IACV,GAAG,MAAM,CAAC;AACZ","debugId":null}},
    {"offset": {"line": 43, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 49, "column": 0}, "map": {"version":3,"sources":["file://D%3A/JewelleryWEBApp/front_end/src/app/DashView/sales/add/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useEffect } from 'react';\nimport { ChevronDown, Plus, X, Search } from 'lucide-react';\nimport { useRouter } from 'next/navigation';\nimport { formatCurrency } from '@/utils/formatters';\n\ninterface JewelleryItem {\n  item_id: number | string;\n  product_title: string;\n  category: string;\n  in_stock: number;\n  selling_price: number;\n  gold_carat?: number;\n  weight?: number;\n  is_solid_gold?: boolean;\n  assay_certificate?: string;\n  assay_status?: string;\n}\n\ninterface SaleItem {\n  item_id: number | string;\n  product_title: string;\n  quantity: number;\n  unit_price: number;\n  original_price?: number;\n  discount_amount?: number;\n  discount_type?: 'percentage' | 'fixed';\n  subtotal: number;\n  // Gold-related properties\n  gold_carat?: number;\n  gold_weight?: number;\n  gold_price_per_gram?: number;\n  is_gold_price_based?: boolean;\n}\n\nconst AddSalePage = () => {\n  const router = useRouter();\n\n  // Available items from inventory\n  const [availableItems, setAvailableItems] = useState<JewelleryItem[]>([]);\n  const [filteredItems, setFilteredItems] = useState<JewelleryItem[]>([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  // Current sale\n  const [selectedItem, setSelectedItem] = useState<JewelleryItem | null>(null);\n  const [customerName, setCustomerName] = useState('');\n  const [quantity, setQuantity] = useState(1);\n  const [customPrice, setCustomPrice] = useState<number | null>(null);\n  const [discountAmount, setDiscountAmount] = useState<number>(0);\n  const [discountType, setDiscountType] = useState<'percentage' | 'fixed'>('fixed');\n  const [paymentMethod, setPaymentMethod] = useState('Cash');\n  const [saleItems, setSaleItems] = useState<SaleItem[]>([]);\n  const [userId, setUserId] = useState<string | null>(null);\n  const [branchId, setBranchId] = useState<string | null>(null);\n\n  // UI states\n  const [showItemDropdown, setShowItemDropdown] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isFetching, setIsFetching] = useState(false);\n\n  // Gold price states\n  const [baseGoldPrice, setBaseGoldPrice] = useState<number>(0);\n  const [isLoadingGoldPrice, setIsLoadingGoldPrice] = useState<boolean>(false);\n  const [goldPriceLastUpdated, setGoldPriceLastUpdated] = useState<string>('');\n  const [useGoldPriceCalculation, setUseGoldPriceCalculation] = useState<boolean>(false);\n  const [calculatedPrice, setCalculatedPrice] = useState<number | null>(null);\n\n  // Karat purity mapping\n  const karatPurityMap: Record<string, { purity: number; label: string }> = {\n    '24KT': { purity: 1.0000, label: '24-Karat Gold (99.99% Pure)' },\n    '22KT': { purity: 0.9167, label: '22-Karat Gold (92% Pure)' },\n    '21KT': { purity: 0.8750, label: '21-Karat Gold (88% Pure)' },\n    '18KT': { purity: 0.7500, label: '18-Karat Gold (75% Pure)' },\n    '16KT': { purity: 0.6667, label: '16-Karat Gold (67% Pure)' },\n  };\n\n  // Get user info from localStorage and fetch initial gold price\n  useEffect(() => {\n    const storedUserId = localStorage.getItem('userId');\n    const storedBranchId = localStorage.getItem('branchId');\n\n    if (storedUserId) {\n      setUserId(storedUserId);\n      console.log('User ID set from localStorage:', storedUserId);\n    }\n\n    if (storedBranchId) {\n      setBranchId(storedBranchId);\n      console.log('Branch ID set from localStorage:', storedBranchId);\n    }\n\n    // Fetch initial gold price\n    fetchGoldPrice();\n  }, []);\n\n  // Function to fetch current gold price (24K)\n  const fetchGoldPrice = async () => {\n    try {\n      setIsLoadingGoldPrice(true);\n      const response = await fetch('http://localhost:3002/gold-prices/current-price');\n      const data = await response.json();\n\n      if (data.success) {\n        // Store the 24K base price\n        setBaseGoldPrice(data.price);\n\n        // Format the timestamp\n        const date = new Date(data.timestamp);\n        setGoldPriceLastUpdated(date.toLocaleString());\n\n        return data.price;\n      } else {\n        console.error('Failed to fetch gold price:', data.message);\n        return 0;\n      }\n    } catch (error) {\n      console.error('Error fetching gold price:', error);\n      return 0;\n    } finally {\n      setIsLoadingGoldPrice(false);\n    }\n  };\n\n  // Function to fetch gold price for a specific karat\n  const fetchKaratPrice = async (karat: number) => {\n    try {\n      setIsLoadingGoldPrice(true);\n      const response = await fetch(`http://localhost:3002/gold-prices/karat-price/${karat}KT`);\n      const data = await response.json();\n\n      if (data.success) {\n        // Format the timestamp\n        const date = new Date(data.timestamp);\n        setGoldPriceLastUpdated(date.toLocaleString());\n\n        return data.price;\n      } else {\n        console.error(`Failed to fetch ${karat}KT gold price:`, data.message);\n        return 0;\n      }\n    } catch (error) {\n      console.error(`Error fetching ${karat}KT gold price:`, error);\n      return 0;\n    } finally {\n      setIsLoadingGoldPrice(false);\n    }\n  };\n\n  // Function to fetch gold stock data\n  const fetchGoldStock = async () => {\n    try {\n      const response = await fetch('http://localhost:3002/gold-stock');\n      const data = await response.json();\n\n      if (data.success) {\n        return data.data;\n      } else {\n        console.error('Failed to fetch gold stock:', data.message);\n        return [];\n      }\n    } catch (error) {\n      console.error('Error fetching gold stock:', error);\n      return [];\n    }\n  };\n\n  // Calculate gold price based on karat and weight\n  const calculateGoldPrice = (basePrice: number, karat: string, weight: number) => {\n    if (!karat || !weight || weight <= 0 || basePrice <= 0) return 0;\n\n    // Get purity for the karat\n    const purity = karatPurityMap[karat]?.purity || 0;\n    if (purity <= 0) return 0;\n\n    // Calculate price based on purity and weight\n    return basePrice * purity * weight;\n  };\n\n  // Fetch available items\n  useEffect(() => {\n    const fetchAvailableItems = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n\n        // First test if the sale items router is working\n        console.log('Testing sale items router...');\n        const testResponse = await fetch(`http://localhost:3002/sale-items/test?t=${new Date().getTime()}`);\n\n        if (!testResponse.ok) {\n          console.error('Test route failed:', testResponse.status);\n          throw new Error(`Sale items API test failed: ${testResponse.status}`);\n        }\n\n        const testData = await testResponse.json();\n        console.log('Test route response:', testData);\n\n        // If test route works, try the actual endpoint with branch filtering\n        console.log('Fetching available items for branch:', branchId);\n\n        // Construct URL with branch_id parameter if available\n        let url = `http://localhost:3002/sale-items/available?t=${new Date().getTime()}`;\n        if (branchId) {\n          url += `&branch_id=${branchId}`;\n        }\n\n        const response = await fetch(url);\n\n        if (!response.ok) {\n          const errorData = await response.json().catch(() => ({}));\n          const errorMessage = errorData.message || `Failed to fetch available items: ${response.status}`;\n          throw new Error(errorMessage);\n        }\n\n        let data = await response.json();\n        console.log('Initial fetch - available items:', data); // Debug log\n\n        // Add test gold items for demonstration\n        const hasGoldItems = data.some((item: JewelleryItem) => item.is_solid_gold && item.gold_carat && item.weight);\n\n        if (!hasGoldItems) {\n          console.log('Adding test gold items for demonstration');\n\n          // Add test gold items\n          const testGoldItems = [\n            {\n              item_id: 'gold-1',\n              product_title: 'Gold Necklace 22KT',\n              category: 'Necklace',\n              in_stock: 5,\n              selling_price: 150000,\n              is_solid_gold: true,\n              gold_carat: 22,\n              weight: 15.5,\n              assay_certificate: 'CERT-001'\n            },\n            {\n              item_id: 'gold-2',\n              product_title: 'Gold Ring 18KT',\n              category: 'Rings',\n              in_stock: 10,\n              selling_price: 55000,\n              is_solid_gold: true,\n              gold_carat: 18,\n              weight: 5.2\n            },\n            {\n              item_id: 'gold-3',\n              product_title: 'Pure Gold Bangle 24KT',\n              category: 'Bangles',\n              in_stock: 3,\n              selling_price: 200000,\n              is_solid_gold: true,\n              gold_carat: 24,\n              weight: 12.8,\n              assay_certificate: 'CERT-002'\n            }\n          ];\n\n          data = [...data, ...testGoldItems];\n        }\n\n        setAvailableItems(data);\n        setFilteredItems(data);\n\n        // Fetch gold price to have it ready\n        fetchGoldPrice();\n      } catch (err) {\n        console.error('Error fetching available items:', err);\n        setError('Failed to fetch items. Please try again.');\n\n        // Initialize with empty arrays instead of sample data\n        setAvailableItems([]);\n        setFilteredItems([]);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchAvailableItems();\n  }, [branchId]);\n\n  // Filter items based on search term\n  useEffect(() => {\n    if (searchTerm.trim() === '') {\n      setFilteredItems(availableItems);\n    } else {\n      const term = searchTerm.toLowerCase();\n      const filtered = availableItems.filter(item =>\n        item.product_title.toLowerCase().includes(term) ||\n        item.category.toLowerCase().includes(term)\n      );\n      setFilteredItems(filtered);\n    }\n  }, [searchTerm, availableItems]);\n\n  // Calculate price after discount\n  const calculatePriceAfterDiscount = (originalPrice: number, discountAmount: number, discountType: 'percentage' | 'fixed'): number => {\n    if (discountAmount <= 0) return originalPrice;\n\n    if (discountType === 'percentage') {\n      // Limit percentage discount to 75%\n      const limitedPercentage = Math.min(discountAmount, 75);\n      return originalPrice * (1 - limitedPercentage / 100);\n    } else {\n      // For fixed discount, ensure it doesn't exceed 75% of the original price\n      const maxDiscount = originalPrice * 0.75;\n      const limitedDiscount = Math.min(discountAmount, maxDiscount);\n      return originalPrice - limitedDiscount;\n    }\n  };\n\n  // Calculate final price for the current item\n  const getFinalUnitPrice = () => {\n    if (!selectedItem) return 0;\n\n    // Start with either custom price, calculated gold price, or original selling price\n    let basePrice = selectedItem.selling_price;\n\n    if (customPrice !== null) {\n      basePrice = customPrice;\n    } else if (useGoldPriceCalculation && calculatedPrice && calculatedPrice > 0) {\n      basePrice = calculatedPrice;\n    }\n\n    // Apply discount\n    return calculatePriceAfterDiscount(basePrice, discountAmount, discountType);\n  };\n\n  // Calculate total\n  const totalAmount = saleItems.reduce((sum, item) => sum + item.subtotal, 0);\n\n  // Handle item selection\n  const handleSelectItem = async (item: JewelleryItem) => {\n    if (item.in_stock <= 0) {\n      setError(`${item.product_title} is out of stock`);\n      return;\n    }\n\n    setSelectedItem(item);\n    setQuantity(1);\n    setCustomPrice(null); // Reset custom price\n    setDiscountAmount(0); // Reset discount\n    setDiscountType('fixed'); // Reset discount type\n    setShowItemDropdown(false);\n    setError(null);\n\n    // Check if it's a gold item with carat and weight\n    // Note: We check for weight and gold_carat directly since is_solid_gold might not be properly set\n    if ((item.is_solid_gold ||\n         (item.gold_carat !== undefined && item.gold_carat > 0) ||\n         (item.weight !== undefined && item.weight > 0)) &&\n        item.gold_carat &&\n        item.weight) {\n      console.log('Gold item detected:', item);\n      setUseGoldPriceCalculation(true);\n\n      try {\n        // Fetch gold stock data to get the price for the specific karat\n        const goldStockData = await fetchGoldStock();\n\n        // Find the matching karat in gold stock\n        const karat = `${item.gold_carat}KT`;\n        const goldStockItem = goldStockData.find((stock: any) => stock.purity === karat);\n\n        let goldPrice;\n\n        if (goldStockItem && goldStockItem.price_per_gram > 0) {\n          // Use the price from gold stock if available\n          goldPrice = goldStockItem.price_per_gram;\n          console.log(`Using gold price from stock for ${karat}: ${goldPrice}`);\n        } else {\n          // Fallback to fetching current gold price and calculating based on purity\n          const baseGoldPrice = await fetchGoldPrice();\n          const purity = karatPurityMap[karat]?.purity || 0;\n          goldPrice = baseGoldPrice * purity;\n          console.log(`Calculated gold price for ${karat}: ${goldPrice} (base: ${baseGoldPrice}, purity: ${purity})`);\n        }\n\n        // Calculate price based on gold price and weight\n        const calculatedGoldPrice = goldPrice * item.weight;\n\n        if (calculatedGoldPrice > 0) {\n          setCalculatedPrice(calculatedGoldPrice);\n          // We don't automatically set custom price to allow user to see both prices\n        }\n      } catch (error) {\n        console.error('Error calculating gold price:', error);\n\n        // Fallback to original calculation method\n        const goldPrice = await fetchGoldPrice();\n        const karat = `${item.gold_carat}KT`;\n        const calculatedGoldPrice = calculateGoldPrice(goldPrice, karat, item.weight);\n\n        if (calculatedGoldPrice > 0) {\n          setCalculatedPrice(calculatedGoldPrice);\n        }\n      }\n    } else {\n      setUseGoldPriceCalculation(false);\n      setCalculatedPrice(null);\n    }\n  };\n\n  // Handle adding item to sale\n  const handleAddItem = () => {\n    return new Promise<boolean>((resolve) => {\n      if (!selectedItem) {\n        setError('Please select an item');\n        resolve(false);\n        return;\n      }\n\n      if (quantity <= 0) {\n        setError('Quantity must be greater than 0');\n        resolve(false);\n        return;\n      }\n\n      if (quantity > selectedItem.in_stock) {\n        setError(`Only ${selectedItem.in_stock} items available in stock`);\n        resolve(false);\n        return;\n      }\n\n      // Get the original price (either custom, calculated gold price, or from the item)\n      let originalPrice = selectedItem.selling_price;\n\n      if (customPrice !== null) {\n        originalPrice = customPrice;\n      } else if (useGoldPriceCalculation && calculatedPrice && calculatedPrice > 0) {\n        originalPrice = calculatedPrice;\n      }\n\n      // Calculate the final unit price after discount\n      const finalPrice = getFinalUnitPrice();\n\n      // Calculate subtotal based on the final price\n      const subtotal = quantity * finalPrice;\n\n      // Create the new item with gold information if applicable\n      const newItem: SaleItem = {\n        item_id: selectedItem.item_id,\n        product_title: selectedItem.product_title,\n        quantity,\n        original_price: originalPrice,\n        unit_price: finalPrice,\n        discount_amount: discountAmount > 0 ? discountAmount : undefined,\n        discount_type: discountAmount > 0 ? discountType : undefined,\n        subtotal,\n        // Add gold-related information if this is a gold item\n        gold_carat: (selectedItem.is_solid_gold || (selectedItem.gold_carat !== undefined && selectedItem.gold_carat > 0)) ? selectedItem.gold_carat : undefined,\n        gold_weight: (selectedItem.is_solid_gold || (selectedItem.weight !== undefined && selectedItem.weight > 0)) ? selectedItem.weight : undefined,\n        gold_price_per_gram: (useGoldPriceCalculation && baseGoldPrice > 0) ? baseGoldPrice : undefined,\n        is_gold_price_based: useGoldPriceCalculation && calculatedPrice !== null && calculatedPrice > 0 && customPrice === calculatedPrice\n      };\n\n      // Check if item already exists in sale\n      const existingItemIndex = saleItems.findIndex(item => item.item_id === selectedItem.item_id);\n\n      if (existingItemIndex >= 0) {\n        // Update existing item\n        const updatedItems = [...saleItems];\n        const existingItem = updatedItems[existingItemIndex];\n\n        // Check if new total quantity exceeds stock\n        const newTotalQuantity = existingItem.quantity + quantity;\n\n        if (newTotalQuantity > selectedItem.in_stock) {\n          setError(`Cannot add more than ${selectedItem.in_stock} items (${existingItem.quantity} already in cart)`);\n          resolve(false);\n          return;\n        }\n\n        updatedItems[existingItemIndex] = {\n          ...existingItem,\n          quantity: newTotalQuantity,\n          subtotal: newTotalQuantity * existingItem.unit_price\n        };\n\n        setSaleItems(updatedItems);\n      } else {\n        // Add new item\n        setSaleItems(prevItems => [...prevItems, newItem]);\n      }\n\n      // Reset selection\n      setSelectedItem(null);\n      setQuantity(1);\n      setError(null);\n      resolve(true);\n    });\n  };\n\n  // Handle removing item from sale\n  const handleRemoveItem = (index: number) => {\n    const updatedItems = [...saleItems];\n    updatedItems.splice(index, 1);\n    setSaleItems(updatedItems);\n  };\n\n  // Handle form submission\n  const handleSubmit = async () => {\n    // Validate form\n    if (!customerName.trim()) {\n      setError('Please enter customer name');\n      return;\n    }\n\n    // Check if there are items in the cart\n    if (saleItems.length === 0) {\n      // If no items in cart, check if an item is selected\n      if (selectedItem) {\n        // Try to add the selected item\n        const added = await handleAddItem();\n        if (!added) {\n          return; // If adding the item failed, stop the submission\n        }\n\n        // Wait a moment for state to update\n        await new Promise(resolve => setTimeout(resolve, 100));\n      } else {\n        // No items in cart and no item selected\n        setError('Please select and add at least one item');\n        return;\n      }\n\n      // Double-check that we now have items in the cart\n      if (saleItems.length === 0) {\n        setError('Please add at least one item using the ADD MORE button');\n        return;\n      }\n    }\n\n    setIsSubmitting(true);\n    setError(null);\n\n    try {\n      const saleData = {\n        customer_name: customerName,\n        total_amount: totalAmount, // Add the total amount field\n        payment_method: paymentMethod,\n        items: saleItems.map(item => ({\n          item_id: item.item_id,\n          quantity: item.quantity,\n          unit_price: item.unit_price,\n          original_price: item.original_price,\n          discount_amount: item.discount_amount,\n          discount_type: item.discount_type,\n          // Include gold-related information if available\n          gold_carat: item.gold_carat,\n          gold_weight: item.gold_weight,\n          gold_price_per_gram: item.gold_price_per_gram,\n          is_gold_price_based: item.is_gold_price_based\n        })),\n        user_id: userId,\n        branch_id: branchId\n      };\n\n      console.log('Submitting sale with user_id:', userId, 'and branch_id:', branchId);\n\n      const response = await fetch('http://localhost:3002/sales/create', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(saleData)\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        let errorMessage = errorData.message || `Failed to create sale: ${response.status}`;\n\n        // Check for specific error messages\n        if (errorData.error && errorData.error.includes('foreign key constraint fails')) {\n          errorMessage = 'One or more items do not exist in the inventory. Please refresh the page and try again.';\n        }\n\n        throw new Error(errorMessage);\n      }\n\n      const result = await response.json();\n\n      alert(`Sale created successfully! Invoice #: ${result.invoice_number}`);\n\n      // Redirect to view sales page\n      router.push('/DashView/sales/view');\n    } catch (err) {\n      console.error('Error creating sale:', err);\n      setError(err instanceof Error ? err.message : 'An unknown error occurred');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  // Handle view sales\n  const handleViewSales = () => {\n    router.push('/DashView/sales/view');\n  };\n\n  // Payment method options\n  const paymentMethods = ['Cash', 'Credit Card', 'Debit Card', 'Bank Transfer', 'Check'];\n\n  if (loading) {\n    return (\n      <div className=\"p-6 max-w-4xl mx-auto flex justify-center items-center h-64\">\n        <div className=\"w-12 h-12 border-4 border-yellow-400 border-t-transparent rounded-full animate-spin\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6 max-w-4xl mx-auto\">\n      <div className=\"bg-white rounded-lg shadow-md p-6\">\n        <h2 className=\"text-2xl font-bold mb-6\">Add Sale</h2>\n\n        {/* Search Bar */}\n        <div className=\"mb-6\">\n          <div className=\"relative\">\n            <input\n              type=\"text\"\n              placeholder=\"Search by item name\"\n              className=\"w-full p-3 pl-10 pr-4 border border-gray-300 rounded-md\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              onFocus={() => setShowItemDropdown(true)}\n            />\n            <Search className=\"absolute left-3 top-3.5 text-gray-400\" size={18} />\n            <button\n              className=\"absolute right-3 top-2.5 bg-yellow-400 text-black px-4 py-1 rounded-full\"\n              onClick={() => {\n                setShowItemDropdown(true);\n                setIsFetching(true);\n                setError(null); // Clear any previous errors\n\n                // First test if the sale items router is working\n                fetch(`http://localhost:3002/sale-items/test?t=${new Date().getTime()}`)\n                  .then(response => {\n                    if (!response.ok) {\n                      throw new Error(`Test route failed: ${response.status}`);\n                    }\n                    return response.json();\n                  })\n                  .then(data => {\n                    console.log('Test route response:', data);\n                    // If test route works, try the actual endpoint with branch filtering\n                    let url = `http://localhost:3002/sale-items/available?t=${new Date().getTime()}`;\n                    if (branchId) {\n                      url += `&branch_id=${branchId}`;\n                    }\n                    console.log('Fetching available items for branch:', branchId);\n                    return fetch(url)\n                  })\n                  .then(response => {\n                    if (!response.ok) {\n                      throw new Error(`Failed to fetch: ${response.status}`);\n                    }\n                    return response.json();\n                  })\n                  .then(data => {\n                    console.log('Fetched items:', data); // Debug log\n                    setAvailableItems(data);\n\n                    // Filter based on search term if provided\n                    const filtered = searchTerm.trim() ?\n                      data.filter((item: JewelleryItem) =>\n                        item.product_title.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                        item.category.toLowerCase().includes(searchTerm.toLowerCase())\n                      ) : data;\n\n                    setFilteredItems(filtered);\n                    setIsFetching(false);\n                  })\n                  .catch(err => {\n                    console.error('Error fetching items:', err);\n                    setError('Failed to fetch items. Please try again.');\n                    setIsFetching(false);\n                  });\n              }}\n            >\n              {isFetching ? (\n                <span className=\"flex items-center\">\n                  <span className=\"w-3 h-3 mr-1 border-2 border-t-transparent border-white rounded-full animate-spin\"></span>\n                  Loading...\n                </span>\n              ) : 'Find'}\n            </button>\n          </div>\n\n          {/* Item Dropdown */}\n          {showItemDropdown && (\n            <div className=\"absolute z-10 mt-1 w-full max-w-3xl bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto\">\n              {filteredItems.length === 0 ? (\n                <div className=\"p-3 text-gray-500\">\n                  {availableItems.length === 0 ?\n                    'No items available in stock. Please add inventory first.' :\n                    'No items found matching your search. Try a different search term.'}\n                </div>\n              ) : (\n                filteredItems.map(item => (\n                  <div\n                    key={item.item_id}\n                    className={`p-3 hover:bg-gray-100 cursor-pointer flex justify-between items-center ${\n                      (item.is_solid_gold || (item.gold_carat !== undefined && item.gold_carat > 0) || (item.weight !== undefined && item.weight > 0)) ? 'border-l-4 border-yellow-400' : ''\n                    }`}\n                    onClick={() => handleSelectItem(item)}\n                  >\n                    <div className=\"flex-1\">\n                      <div className=\"font-medium\">{item.product_title}</div>\n                      <div className=\"text-sm text-gray-500\">{item.category}</div>\n                      {((item.is_solid_gold || (item.gold_carat !== undefined && item.gold_carat > 0) || (item.weight !== undefined && item.weight > 0)) && item.gold_carat && item.weight) && (\n                        <div className=\"flex items-center mt-1\">\n                          <span className=\"inline-block w-3 h-3 bg-yellow-400 rounded-full mr-1\"></span>\n                          <span className=\"text-xs font-medium text-yellow-700\">\n                            {item.gold_carat}KT Gold • {item.weight}g\n                            {item.assay_certificate && (\n                              <span className=\"ml-1 text-green-600\">• Certified</span>\n                            )}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                    <div className=\"text-right ml-4\">\n                      <div className=\"font-medium\">{formatCurrency(item.selling_price)}</div>\n                      <div className={`text-sm ${item.in_stock > 0 ? 'text-gray-500' : 'text-red-500 font-bold'}`}>\n                        In stock: {item.in_stock}\n                      </div>\n                      {(item.is_solid_gold || (item.gold_carat !== undefined && item.gold_carat > 0) || (item.weight !== undefined && item.weight > 0)) && (\n                        <div className=\"text-xs text-yellow-600 mt-1\">\n                          Gold Item\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                ))\n              )}\n            </div>\n          )}\n        </div>\n\n        {/* Sale Form */}\n        <div className=\"space-y-4\">\n          {/* Selected Item */}\n          <div className=\"flex items-center\">\n            <div className=\"w-32 font-medium\">Item</div>\n            <div className=\"flex-1\">\n              <div className=\"p-3 bg-gray-100 rounded-md\">\n                {selectedItem ? selectedItem.product_title : 'No item selected'}\n              </div>\n            </div>\n          </div>\n\n          {/* Customer Name */}\n          <div className=\"flex items-center\">\n            <div className=\"w-32 font-medium\">Customer Name</div>\n            <div className=\"flex-1\">\n              <input\n                type=\"text\"\n                className=\"w-full p-3 border border-gray-300 rounded-md\"\n                value={customerName}\n                onChange={(e) => setCustomerName(e.target.value)}\n                placeholder=\"Enter customer name\"\n              />\n            </div>\n          </div>\n\n          {/* Gold Item Details (if applicable) */}\n          {selectedItem && (selectedItem.is_solid_gold || (selectedItem.gold_carat !== undefined && selectedItem.gold_carat > 0) || (selectedItem.weight !== undefined && selectedItem.weight > 0)) && selectedItem.gold_carat && selectedItem.weight && (\n            <div className=\"flex items-center mb-4\">\n              <div className=\"w-32 font-medium\">Gold Details</div>\n              <div className=\"flex-1\">\n                <div className=\"p-3 bg-yellow-50 border border-yellow-200 rounded-md\">\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-sm font-medium\">Karat:</span>\n                    <span className=\"text-sm font-bold\">{selectedItem.gold_carat}KT</span>\n                  </div>\n                  <div className=\"flex justify-between mt-1\">\n                    <span className=\"text-sm font-medium\">Weight:</span>\n                    <span className=\"text-sm font-bold\">{selectedItem.weight} grams</span>\n                  </div>\n\n                  {/* Gold Price Information */}\n                  <div className=\"mt-3 pt-2 border-t border-yellow-200\">\n                    <div className=\"text-sm font-medium mb-1\">Gold Price Information:</div>\n\n                    {isLoadingGoldPrice ? (\n                      <div className=\"flex items-center justify-center py-2\">\n                        <span className=\"inline-block w-4 h-4 mr-1 border-2 border-t-transparent border-yellow-400 rounded-full animate-spin\"></span>\n                        <span className=\"text-sm\">Loading gold price...</span>\n                      </div>\n                    ) : (\n                      <>\n                        <div className=\"flex justify-between mt-1\">\n                          <span className=\"text-sm\">24KT Base Price:</span>\n                          <div className=\"flex items-center\">\n                            <span className=\"text-sm mr-2\">{formatCurrency(baseGoldPrice)}/gram</span>\n                            <button\n                              type=\"button\"\n                              className=\"text-xs bg-yellow-400 text-black px-2 py-0.5 rounded\"\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                fetchGoldPrice().then(price => {\n                                  if (price > 0 && selectedItem?.gold_carat && selectedItem?.weight) {\n                                    // Re-trigger the item selection to recalculate everything\n                                    handleSelectItem(selectedItem);\n                                  }\n                                });\n                              }}\n                            >\n                              Refresh\n                            </button>\n                          </div>\n                        </div>\n\n                        <div className=\"flex justify-between mt-1\">\n                          <span className=\"text-sm\">{selectedItem.gold_carat}KT Price:</span>\n                          <span className=\"text-sm\">\n                            {formatCurrency(baseGoldPrice * karatPurityMap[`${selectedItem.gold_carat}KT`]?.purity || 0)}/gram\n                          </span>\n                        </div>\n\n                        {goldPriceLastUpdated && (\n                          <div className=\"text-xs text-gray-500 mt-1 text-right\">\n                            Last updated: {goldPriceLastUpdated}\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n\n                  {/* Calculation */}\n                  {calculatedPrice && calculatedPrice > 0 && (\n                    <div className=\"mt-3 pt-2 border-t border-yellow-200\">\n                      <div className=\"text-sm font-medium mb-1\">Price Calculation:</div>\n                      <div className=\"grid grid-cols-2 gap-1 text-sm\">\n                        <span>Gold Price:</span>\n                        <span className=\"text-right\">\n                          {formatCurrency(baseGoldPrice * karatPurityMap[`${selectedItem.gold_carat}KT`]?.purity || 0)}/gram\n                        </span>\n                        <span>Weight:</span>\n                        <span className=\"text-right\">{selectedItem.weight} grams</span>\n                        <span className=\"font-medium\">Total Gold Value:</span>\n                        <span className=\"text-right font-bold\">{formatCurrency(calculatedPrice)}</span>\n                      </div>\n\n                      <div className=\"mt-2 flex justify-end\">\n                        <button\n                          type=\"button\"\n                          className=\"bg-yellow-400 text-black px-2 py-1 rounded text-xs\"\n                          onClick={() => setCustomPrice(calculatedPrice)}\n                        >\n                          Use Gold Price\n                        </button>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Unit Price */}\n          <div className=\"flex items-center\">\n            <div className=\"w-32 font-medium\">Unit price</div>\n            <div className=\"flex-1\">\n              {selectedItem ? (\n                <div className=\"relative\">\n                  <input\n                    type=\"number\"\n                    className={`w-full p-3 border ${\n                      calculatedPrice && calculatedPrice > 0\n                        ? 'border-yellow-400'\n                        : 'border-gray-300'\n                    } rounded-md`}\n                    value={customPrice !== null ? customPrice : selectedItem.selling_price}\n                    onChange={(e) => {\n                      const value = parseFloat(e.target.value);\n                      if (!isNaN(value) && value > 0) {\n                        setCustomPrice(value);\n                      } else if (e.target.value === '') {\n                        setCustomPrice(null); // Reset to original price\n                      }\n                    }}\n                    placeholder=\"Enter custom price\"\n                    min=\"0\"\n                    step=\"0.01\"\n                  />\n\n                  {/* Price selection buttons */}\n                  <div className=\"absolute right-2 top-2 flex space-x-1\">\n                    {calculatedPrice && calculatedPrice > 0 && (\n                      <button\n                        type=\"button\"\n                        className={`px-2 py-1 rounded text-xs ${\n                          customPrice === calculatedPrice\n                            ? 'bg-yellow-500 text-white'\n                            : 'bg-yellow-400 text-black'\n                        }`}\n                        onClick={() => setCustomPrice(calculatedPrice)}\n                      >\n                        Use Gold Price\n                      </button>\n                    )}\n\n                    {customPrice !== null && (\n                      <button\n                        type=\"button\"\n                        className=\"bg-gray-200 text-gray-700 px-2 py-1 rounded text-xs\"\n                        onClick={() => setCustomPrice(null)}\n                      >\n                        Reset\n                      </button>\n                    )}\n                  </div>\n                </div>\n              ) : (\n                <div className=\"p-3 bg-gray-100 rounded-md\">0.00</div>\n              )}\n\n              {/* Price comparison information */}\n              <div className=\"mt-2 grid grid-cols-2 gap-2\">\n                {selectedItem && (\n                  <div className={`text-xs ${customPrice !== null ? 'text-gray-500' : 'text-black font-medium'}`}>\n                    <span className=\"mr-1\">Catalog price:</span>\n                    <span>{formatCurrency(selectedItem.selling_price)}</span>\n                  </div>\n                )}\n\n                {calculatedPrice && calculatedPrice > 0 && (\n                  <div className={`text-xs ${customPrice === calculatedPrice ? 'text-yellow-600 font-medium' : 'text-yellow-600'}`}>\n                    <span className=\"mr-1\">Gold value price:</span>\n                    <span>{formatCurrency(calculatedPrice)}</span>\n                  </div>\n                )}\n\n                {customPrice !== null && customPrice !== calculatedPrice && selectedItem && customPrice !== selectedItem.selling_price && (\n                  <div className=\"text-xs text-blue-600 font-medium\">\n                    <span className=\"mr-1\">Custom price:</span>\n                    <span>{formatCurrency(customPrice)}</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n\n          {/* Discount */}\n          <div className=\"flex items-center\">\n            <div className=\"w-32 font-medium\">Discount</div>\n            <div className=\"flex-1 flex space-x-2\">\n              <input\n                type=\"number\"\n                className=\"flex-1 p-3 border border-gray-300 rounded-md\"\n                value={discountAmount}\n                onChange={(e) => {\n                  const value = parseFloat(e.target.value);\n                  if (!isNaN(value) && value >= 0) {\n                    // For percentage, limit to 75%\n                    if (discountType === 'percentage' && value > 75) {\n                      setError('Maximum discount allowed is 75%');\n                      setDiscountAmount(75);\n                    } else if (discountType === 'fixed' && selectedItem) {\n                      // For fixed amount, limit to 75% of the price\n                      const basePrice = customPrice !== null ? customPrice : selectedItem.selling_price;\n                      const maxDiscount = basePrice * 0.75;\n                      if (value > maxDiscount) {\n                        setError(`Maximum discount allowed is ${formatCurrency(maxDiscount)}`);\n                        setDiscountAmount(maxDiscount);\n                      } else {\n                        setDiscountAmount(value);\n                        setError(null);\n                      }\n                    } else {\n                      setDiscountAmount(value);\n                      setError(null);\n                    }\n                  } else {\n                    setDiscountAmount(0);\n                  }\n                }}\n                min=\"0\"\n                step={discountType === 'percentage' ? '1' : '0.01'}\n                disabled={!selectedItem}\n              />\n              <select\n                className=\"p-3 border border-gray-300 rounded-md\"\n                value={discountType}\n                onChange={(e) => setDiscountType(e.target.value as 'percentage' | 'fixed')}\n                disabled={!selectedItem}\n              >\n                <option value=\"fixed\">₹</option>\n                <option value=\"percentage\">%</option>\n              </select>\n            </div>\n          </div>\n\n          {/* Final Price After Discount */}\n          <div className=\"flex items-center\">\n            <div className=\"w-32 font-medium\">Final price</div>\n            <div className=\"flex-1\">\n              <div className=\"p-3 bg-gray-100 rounded-md font-bold\">\n                {selectedItem ? formatCurrency(getFinalUnitPrice()) : '0.00'}\n              </div>\n              {discountAmount > 0 && selectedItem && (\n                <div className=\"text-xs text-green-600 mt-1\">\n                  {discountType === 'percentage'\n                    ? `${discountAmount}% discount applied`\n                    : `${formatCurrency(discountAmount)} discount applied`}\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Quantity */}\n          <div className=\"flex items-center\">\n            <div className=\"w-32 font-medium\">Quantity</div>\n            <div className=\"flex-1 relative\">\n              <input\n                type=\"number\"\n                className=\"w-full p-3 border border-gray-300 rounded-md pr-10\"\n                value={quantity}\n                onChange={(e) => setQuantity(Math.max(1, parseInt(e.target.value) || 1))}\n                min=\"1\"\n                max={selectedItem?.in_stock || 1}\n              />\n              <div className=\"absolute right-3 top-3\">\n                <ChevronDown size={18} className=\"text-gray-400\" />\n              </div>\n            </div>\n          </div>\n\n          {/* Total for current item */}\n          <div className=\"flex items-center\">\n            <div className=\"w-32 font-medium\">Total</div>\n            <div className=\"flex-1\">\n              <div className=\"p-3 bg-gray-100 rounded-md\">\n                {selectedItem ? formatCurrency(getFinalUnitPrice() * quantity) : '0.00'}\n              </div>\n            </div>\n          </div>\n\n          {/* Payment Method */}\n          <div className=\"flex items-center\">\n            <div className=\"w-32 font-medium\">Payment Method</div>\n            <div className=\"flex-1 relative\">\n              <select\n                className=\"w-full p-3 border border-gray-300 rounded-md appearance-none\"\n                value={paymentMethod}\n                onChange={(e) => setPaymentMethod(e.target.value)}\n              >\n                {paymentMethods.map(method => (\n                  <option key={method} value={method}>{method}</option>\n                ))}\n              </select>\n              <div className=\"absolute right-3 top-3 pointer-events-none\">\n                <ChevronDown size={18} className=\"text-gray-400\" />\n              </div>\n            </div>\n          </div>\n\n          {/* Error Message */}\n          {error && (\n            <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">\n              {error}\n            </div>\n          )}\n\n          {/* Add More Button */}\n          <div className=\"flex justify-center\">\n            <button\n              type=\"button\"\n              className={`${saleItems.length === 0 ? 'bg-yellow-400 animate-pulse' : 'bg-yellow-400'} text-black px-6 py-2 rounded-full font-medium flex items-center`}\n              onClick={handleAddItem}\n              disabled={!selectedItem || isSubmitting}\n              title=\"Add this item to the sale\"\n            >\n              <Plus size={18} className=\"mr-1\" />\n              {saleItems.length === 0 ? 'ADD ITEM ' : 'ADD MORE'}\n            </button>\n          </div>\n          {saleItems.length === 0 && selectedItem && (\n            <div className=\"text-center text-sm text-yellow-600 mt-2\">\n              ⚠️ You must click the button above to add the item to your cart first\n            </div>\n          )}\n\n          {/* Sale Items List */}\n          {saleItems.length > 0 && (\n            <div className=\"mt-6\">\n              <h3 className=\"font-bold mb-2\">Items in this sale:</h3>\n              <div className=\"border rounded-md overflow-hidden\">\n                <table className=\"min-w-full divide-y divide-gray-200\">\n                  <thead className=\"bg-gray-50\">\n                    <tr>\n                      <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase\">Item</th>\n                      <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase\">Quantity</th>\n                      <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase\">Original Price</th>\n                      <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase\">Discount</th>\n                      <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase\">Final Price</th>\n                      <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase\">Subtotal</th>\n                      <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase\">Action</th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"bg-white divide-y divide-gray-200\">\n                    {saleItems.map((item, index) => (\n                      <tr key={index} className={item.is_gold_price_based ? 'bg-yellow-50' : ''}>\n                        <td className=\"px-4 py-2\">\n                          <div>{item.product_title}</div>\n                          {item.gold_carat && item.gold_weight && (\n                            <div className=\"text-xs text-yellow-600\">\n                              {item.gold_carat}KT Gold • {item.gold_weight}g\n                              {item.gold_price_per_gram && (\n                                <span className=\"ml-1\">• {formatCurrency(item.gold_price_per_gram)}/g</span>\n                              )}\n                            </div>\n                          )}\n                        </td>\n                        <td className=\"px-4 py-2\">{item.quantity}</td>\n                        <td className=\"px-4 py-2\">{formatCurrency(item.original_price || item.unit_price)}</td>\n                        <td className=\"px-4 py-2\">\n                          {item.discount_amount ? (\n                            item.discount_type === 'percentage'\n                              ? `${item.discount_amount}%`\n                              : formatCurrency(item.discount_amount)\n                          ) : '-'}\n                        </td>\n                        <td className=\"px-4 py-2\">\n                          <div className=\"font-medium\">{formatCurrency(item.unit_price)}</div>\n                          {item.is_gold_price_based && (\n                            <div className=\"text-xs text-yellow-600\">Gold price based</div>\n                          )}\n                        </td>\n                        <td className=\"px-4 py-2\">{formatCurrency(item.subtotal)}</td>\n                        <td className=\"px-4 py-2\">\n                          <button\n                            className=\"text-red-500 hover:text-red-700\"\n                            onClick={() => handleRemoveItem(index)}\n                            title=\"Remove item\"\n                          >\n                            <X size={18} />\n                          </button>\n                        </td>\n                      </tr>\n                    ))}\n                    <tr className=\"bg-gray-50 font-bold\">\n                      <td className=\"px-4 py-2\" colSpan={5}>Total</td>\n                      <td className=\"px-4 py-2\">{formatCurrency(totalAmount)}</td>\n                      <td className=\"px-4 py-2\"></td>\n                    </tr>\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          )}\n\n          {/* Action Buttons */}\n          <div className=\"flex justify-between mt-6\">\n            <button\n              type=\"button\"\n              className=\"bg-yellow-400 text-black px-6 py-2 rounded-full font-medium\"\n              onClick={handleSubmit}\n              disabled={isSubmitting}\n              title=\"Confirm this sale\"\n            >\n              {isSubmitting ? 'Processing...' : 'Confirm'}\n            </button>\n            <div className=\"text-xs text-gray-500 mt-1\">\n              {saleItems.length === 0 && 'First select an item, then click ADD MORE'}\n            </div>\n\n            <div className=\"flex space-x-4\">\n              <button\n                type=\"button\"\n                className=\"bg-white border border-gray-300 text-gray-700 px-6 py-2 rounded-full font-medium\"\n                onClick={handleViewSales}\n              >\n                View Sale\n              </button>\n\n              {/* <button\n                type=\"button\"\n                className=\"bg-yellow-400 text-black px-6 py-2 rounded-full font-medium\"\n                onClick={() => alert('Invoice generation will be implemented')}\n                disabled={isSubmitting || saleItems.length === 0}\n              >\n                Generate Invoice\n              </button> */}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AddSalePage;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2055, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}